#!/bin/sh

if [ $# -eq 0 ]; then
	echo 'Usage: init [bash|bat|git|hammerspoon|prettier|ripgrep|tmux|vim|zsh] ...'
else
	SHELL_CONFIGS=".bashrc .zshrc"

	DOTFILES_ABS="$(cd $(dirname $0); pwd -P)"
	DOTFILES="$DOTFILES_ABS"
	case "$DOTFILES" in
		$HOME* ) DOTFILES="~${DOTFILES#$HOME}" ;;
	esac

	for i do
		case "$i" in
			bash )
				echo "source $DOTFILES/.bashrc" >> $HOME/.bashrc
				;;
			bat )
				for SHELL_CONFIG in $SHELL_CONFIGS; do
					if [ -f $HOME/$SHELL_CONFIG ]; then echo "export BAT_CONFIG_PATH=$DOTFILES/bat.conf" >> $HOME/$SHELL_CONFIG; fi
				done
				;;
			git )
				git config --global include.path "$DOTFILES/.gitconfig"
				;;
			hammerspoon )
				mkdir -p $HOME/.hammerspoon/
				echo "dofile('$DOTFILES_ABS/hammerspoon.lua')" >> $HOME/.hammerspoon/init.lua
				;;
			prettier )
				cp $DOTFILES_ABS/.prettierrc $HOME
				;;
			ripgrep )
				for SHELL_CONFIG in $SHELL_CONFIGS; do
					if [ -f $HOME/$SHELL_CONFIG ]; then echo "export RIPGREP_CONFIG_PATH=$DOTFILES/.ripgreprc" >> $HOME/$SHELL_CONFIG; fi
				done
				;;
			tmux )
				if [ ! -d $HOME/.tmux/plugins/tpm ]; then git clone https://github.com/tmux-plugins/tpm $HOME/.tmux/plugins/tpm; fi
				echo "source-file $DOTFILES/.tmux.conf" >> $HOME/.tmux.conf
				;;
			vim )
				echo "source $DOTFILES/.vimrc" >> $HOME/.vimrc
				echo "source $DOTFILES/.vimrc.snippets" >> $HOME/.vimrc
				;;
			zsh )
				echo "source $DOTFILES/.zshrc" >> $HOME/.zshrc
				;;
			* )
				echo "Unrecognized: $i"
				;;
		esac
	done
fi
